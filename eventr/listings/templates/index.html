<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Eventr">
    <meta name="author" content="Eventr">

    <title>Eventr</title>
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;800&display=swap" rel="stylesheet"> 
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" integrity="sha512-1ycn6IcaQQ40/MKBW2W4Rhis/DbILU74C1vSrLJxCq57o941Ym01SwNsOMqvEBFlcgUa6xLiPY/NS5R+E6ztJQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="shortcut icon" type="image/png" href="https://www.favicon.cc/logo3d/631916.png"/> <!-- ðŸ™ˆ -->
    <style>

            /* I have just yonked this CSS from an unused project */

            body {
                font-family: Montserrat, sans-serif;
                font-size: 14px;
                background: #fff;
                color: #000
            }

            body,
            html {
                height: 100%
            }

            h1 {
                font-size: 4.4em
            }

            h2 {
                font-size: 3.6em
            }

            h3 {
                font-size: 2.6em
            }

            h4 {
                font-size: 2.2em
            }

            h5 {
                font-size: 1.8em
            }

            h6 {
                font-size: 1.4em
            }

            h1,
            h2,
            h3,
            h4,
            h5,
            h6 {
                margin: 0
            }

            a {
                color: #000
            }

            a:active,
            a:hover {
                color: #ff3f5f;
                text-decoration: none
            }

            a:focus {
                outline: 0;
                text-decoration: none
            }

            .m-0 {
                margin: 0!important
            }

            .navbar {
                position: absolute;
                left: 30px;
                right: 30px;
                top: 30px;
                height: auto;
                min-height: 0;
                background-color: transparent;
                border: 0;
                border-radius: 0;
                margin: 0;
                z-index: 1051
            }

            .navbar>* {
                padding: 0
            }

            .navbar-brand {
                height: auto;
                padding: 0;
                text-transform: uppercase;
                font-weight: 700;
                font-size: 14px;
                letter-spacing: .5em;
                text-align: right
            }

            .navbar-brand span:last-child {
                -webkit-transform-origin: right top;
                transform-origin: right top
            }

            .navbar-brand span {
                display: block;
                -webkit-transition: all .4s ease;
                transition: all .4s ease
            }

            .navbar-brand span+span {
                margin-top: 5px
            }

            .toggle-navigation {
                position: relative;
                display: block;
                width: 40px;
                height: 36px;
                border: 0;
                background: 0 0;
                padding: 0
            }

            .toggle-navigation>span {
                position: absolute;
                left: 0;
                top: 0;
                display: block;
                height: 4px;
                width: 100%;
                background-color: #000;
                border-radius: 12px;
                -webkit-transition: all .4s;
                transition: all .4s
            }

            .toggle-navigation>span:nth-of-type(2) {
                top: 16px
            }

            .toggle-navigation>span:nth-of-type(3) {
                top: 32px
            }

            .navbar-header {
                display: -webkit-box;
                display: -ms-flexbox;
                display: flex;
                -webkit-box-align: center;
                -ms-flex-align: center;
                align-items: center;
                -webkit-box-pack: justify;
                -ms-flex-pack: justify;
                justify-content: space-between;
                width: 100%;
                float: none
            }

            .navbar-header:after,
            .navbar-header:before {
                display: none
            }

            .container-fluid>.navbar-header,
            .container>.navbar-header {
                margin: 0
            }

            .hero {
                position: relative;
                background-size: cover;
                background-position: center center;
                background-repeat: no-repeat
            }

            #home {
                background-size: cover;
                background-position: center center;
                background-repeat: no-repeat;
                height: 100vh
            }

            .navbar-menu {
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background-color: #000;
                color: #fff;
                animation: fade 1s linear;
                -webkit-transition: all .4s;
                transition: all .4s;
                z-index: 1050;
            }

            .navbar-menu-content {
                position: absolute;
                top: 50%;
                left: 15px;
                width: 100%;
                text-align: center;
                -webkit-transform: translateY(-50%);
                transform: translateY(-50%);
                padding: 75px 0
            }

            .navbar-menu-list {
                list-style: none;
                padding: 0;
                margin: 0
            }

            .navbar-menu-list li+li {
                margin-top: 50px
            }

            .navbar-menu-list li a {
                position: relative;
                display: inline-block;
                text-transform: uppercase;
                font-weight: 700;
                color: inherit;
                letter-spacing: .6em;
                font-size: 24px
            }

            .navbar-menu-list li a:after {
                content: "";
                position: absolute;
                bottom: -12px;
                left: 0;
                width: 65%;
                height: 7px;
                border-radius: 7px;
                background-color: currentColor;
                -webkit-transform: scaleX(0);
                transform: scaleX(0);
                -webkit-transform-origin: left center;
                transform-origin: left center;
                -webkit-transition: -webkit-transform .4s ease;
                transition: -webkit-transform .4s ease;
                transition: transform .4s ease;
                transition: transform .4s ease, -webkit-transform .4s ease
            }

            .navbar-menu-list li a:hover:after {
                -webkit-transform: scaleX(1);
                transform: scaleX(1)
            }

            .navbar-menu-social {
                list-style: none;
                padding: 0;
                margin: 50px -10px 0
            }

            .navbar-menu-social li {
                display: inline-block;
                padding: 0 10px
            }

            .navbar-menu-social li a {
                position: relative;
                width: 32px;
                height: 32px;
                display: block;
                background-color: #fff;
                color: #000;
                border-radius: 50%
            }

            .navbar-menu-social li a i {
                position: absolute;
                top: 50%;
                left: 50%;
                -webkit-transform: translate(-50%, -50%);
                transform: translate(-50%, -50%);
                font-size: 16px
            }

            #page {
                position: relative;
                min-height: calc(100vh - 75px);
                padding: 30px 0
            }

            .content .col {
                position: relative;
                width: 100%
            }

            .content .col-right {
                overflow: hidden
            }

            img[data-bg=true] {
                display: none
            }

            @-webkit-keyframes type {
                0% {
                    opacity: 0
                }
                20% {
                    opacity: 1
                }
                30% {
                    opacity: 1
                }
                100% {
                    opacity: 0
                }
            }

            @keyframes type {
                0% {
                    opacity: 0
                }
                20% {
                    opacity: 1
                }
                30% {
                    opacity: 1
                }
                100% {
                    opacity: 0
                }
            }

            .container {
                width: 100%;
                max-width: 1600px;
                padding: 0 30px
            }

            .container-fluid {
                width: 100%
            }

            .page-content {
                padding: 100px 0
            }

            .valign {
                display: -webkit-box;
                display: -ms-flexbox;
                display: flex;
                -webkit-box-align: center;
                -ms-flex-align: center;
                align-items: center;
                -ms-flex-wrap: wrap;
                flex-wrap: wrap
            }

            .valign>div {
                float: none
            }

            .valign {
                display: -webkit-flex;
                -webkit-flex-wrap: wrap !important;
            }

            .valign:after,
            .valign:before {
                width: 0
            }

            :focus {
                outline: 0!important
            }

            @media all and (min-width:768px) {
                .navbar {
                    top: 72px;
                    left: 72px;
                    right: 72px
                }
                .navbar>* {
                    padding: 0
                }
                .container {
                    padding: 0 72px
                }
                .content {
                    display: -webkit-box;
                    display: -ms-flexbox;
                    display: flex;
                    -webkit-box-pack: justify;
                    -ms-flex-pack: justify;
                    justify-content: space-between
                }
                .content .col {
                    width: 45%
                }
                .navbar-brand {
                    font-size: 18px
                }
                .navbar-brand span+span {
                    margin-top: 10px
                }
                #page {
                    padding: 100px 0;
                    min-height: calc(100vh - 192px)
                }
                .navbar-menu-content {
                    left: 192px;
                    padding: 192px 0;
                    width: auto;
                    text-align: left
                }
                .navbar-menu-list li a {
                    letter-spacing: .6em;
                    font-size: 40px
                }
                .navbar-menu-social {
                    margin: 150px -10px 0
                }
                .navbar-menu-social li a {
                    width: 32px;
                    height: 32px
                }
                .navbar-menu-social li a i {
                    font-size: 22px
                }
            }

            @media all and (max-width:1024px) {
                .valign>* {
                    margin-left: auto;
                    margin-right: auto
                }
                .valign>[class*=col-sm],
                .valign>[class*=col-xs] {
                    margin-left: 0;
                    margin-right: 0
                }
                .valign [class*=col-md] {
                    width: 100%
                }
                .valign>.container {
                    width: 100%
                }
            }

            @media all and (max-width:767px) {
                h1 {
                    font-size: 2.4em;
                    line-height: .9
                }
                h2 {
                    font-size: 2em
                }
                h3 {
                    font-size: 1.8em
                }
                h4 {
                    font-size: 1.6em
                }
                h5 {
                    font-size: 1.4em
                }
                h6 {
                    font-size: 1.2em
                }
            }

            .fa-spinner {
                font-size: 100px;
                text-align: center;
                width: 100%;
                display: block;
                margin-top: 30vh;            
        }
    </style>

        
    <style>
        body {
            font-family: "Montserrat", sans-serif;
        }

        a {
            text-decoration: none;
        }

        .page-content {
            width:90%;
            margin:5rem 4rem;
        }

        .event-search {
            margin: 1rem 0 0 0;
            width: 97%;
            height: 60px;
            border:3px solid black;
            padding: 1.15rem;
        }

        .search-results { 
            margin-bottom: 10%; 
        }

        .search-results__transition {
            display: flex;
            flex-wrap: wrap;
            margin: 10% 0 0 0;
        }

        .search-item {
            width:29%;
            min-width: 250px;
            margin:0 3% 6% 0;
            min-height: 310px;
            border:3px solid black;
            flex-grow: 1;
            position: relative;
        }

        .search-item__image {
            height: 250px;
            width: 100%;
            background-color:rgb(230,230,230);
        }

        .search-item__details {
            padding:0.3rem 0.6rem 0.9rem ;
            text-align: center;
        }
        .search-item__title {
            font-size:1rem;
            display: block;
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            background-color: rgba(255,255,255,0.5);
            padding: 0.6rem 0.9rem;
        }

        .search-item__source_name {
            font-weight: bold;
            display: block;
        }
        .search-item__city {
            font-size:0.8rem;
            font-style: italic;
            display: block;
        }
        .search-item__date {
            font-size:0.7rem;
        }

        .search-item__time {
            border: 1px solid black;
            padding: 0.3rem;
            display: block;
            clear: both;
            width: min-content;
            margin: 0.3rem auto;
        }
        .search-item__description {
            display: block;
            margin-top:0.6rem;
        }

        .search-item__image {
            width: 100%;
            height: 70%;
        }

        .search-list-enter {
            opacity: 0;
        }

        /* Vue has transitions but.... */
        .search-item {    
            animation: fade 1s linear;
        }
        body {
            animation: fadeBody 2s linear;
        }
        
        @keyframes fade {
        0% { opacity: 0; height: 0; }
        100% { opacity: 1; height:100%; }
        }

        @keyframes fadeBody {
        0% { opacity: 0 }
        30% { opacity: 0 }
        100% { opacity: 1 }
        }
    </style>
    </head>

<body>
    <!-- I grabbed this header and CSS from an unused project -->
    <div id="navgroup">
        <nav class="navbar" role="navigation">
            <div class="container-fluid">
                <div class="navbar-header">
                    <button type="button" class="toggle-navigation"  v-on:click="showMenu = !showMenu">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="index.html">
                        <span>Event</span>
                        <span>R</span>
                    </a>
                </div>
            </div>
        </nav>

        <div class="navbar-menu" id="navbar-menu" v-if="showMenu">
            <div class="navbar-menu-content">
                <ul class="navbar-menu-list">
                    <li><a href="about.html">Events</a></li>
                    <li><a href="artist.html">About</a></li>
                    <li><a href="contact.html">Contact</a></li>
                </ul>
                <ul class="navbar-menu-social">
                    <li><a href="#" target="_blank" title="Twitter"><i class="fab fa-twitter"></i></a></li>
                    <li><a href="#" target="_blank" title="Instagram"><i class="fab fa-instagram"></i></a></li>
                    <li><a href="#" target="_blank" title="Spotify"><i class="fab fa-spotify"></i></a></li>
                </ul>
            </div>
        </div>
    </div>
    <!-- -->

    <section id="home" class="page-content">
                <div id="search-tools">

                    <h2> Today's Events</h2>

                    <p>Date range selection hasn't been added, but I would grab a <a style="color:#f3d879; font-weight:bold;" href="https://innologica.github.io/vue2-daterange-picker/#example-playground">vue library</a> to handle input,
                        and the api is fairly straight forwards
                    </p>
                    <input type="search" class="search event-search" v-model="search" placeholder="Event name, city, Venue..." />
                    <div id="search-results" >
                        <transition name="fade">
                        <transition-group name="search" tag="div" class="search-results__transition" >
                            <div class="search-item" v-for="result in filteredList" :key="result.id" v-if="fadeIn" style="transition-delay: 1s">
                                <span class="oooooo">
                                    <img src="https://i.pinimg.com/originals/e0/c7/69/e0c76977caf33ad7c171461b00c0686a.gif" class="search-item__image event-image" />
                                </span>
                                <div class="search-item__details">
                                    <h2 class="search-item__title">[[ result.event.name ]] 
                                    </h2>   
                                    <span class="search-item__source_name">[[ result.event.source.friendly_name ]]</span>
                                    <span class="search-item__city">[[ result.event.source.default_city ]] </span> 
                                    <span class="search-item__date">[[ result.start_datetime ]] </span>
                                    <span class="search-item__time">[[ result.start_clocktime ]]</span>
                                    <span class="search-item__description">[[ result.event.description ]]</span>

                                    </span>
                                </div>
                            </div>
                        </transition-group>
                    </transition>
                        <!-- pagination 

                            Was adding this 
                        <ul class="pagination">
                            <li class="page-item">
                              <button type="button" class="page-link" v-if="page != 1" @click="page--"> Previous </button>
                            </li>
                            <li class="page-item">
                              <button type="button" class="page-link" v-for="pageNumber in pages.slice(page-1, page+5)" @click="page = pageNumber"> {{pageNumber}} </button>
                            </li>
                            <li class="page-item">
                              <button type="button" @click="page++" v-if="page < pages.length" class="page-link"> Next </button>
                            </li>
                          </ul>

                          -->
                    </div>

                </div>
    </section>

    <!-- Wouldn't use vue from a random CDN, npm, yarn, packages, 
        would also check out vue integrations with django 
        that avoid delimiter template issues more easily - but I just want to get 
        a quick template out.  -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.21.4/axios.min.js" integrity="sha512-lTLt+W7MrmDfKam+r3D2LURu0F47a3QaW5nF0c6Hl0JDZ57ruei+ovbg7BrZ+0bjVJ5YgzsAWE+RreERbpPE1g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script>
        var results = new Vue({
          el: '#search-tools',
    	  delimiters: ['[[', ']]'],
          data: {
            search: '',
            results: [],
            stagedResults: [],
            fadeIn: true,
            lockSearch: false,
            /*  I was adding this... 
            page: 0, 
            perPage: 8,
            pages: []
            */
          },
          computed: {
                filteredList: function() {
                    results = this.results.filter(result => {
                        console.log("This runs once for each data item on load") // This runs once for each item in the results. Seems silly.
                        searchInput = this.search.toLowerCase();
                        // Name 
                        nameField = (result.event ?? "").name ?? "" // Modern problems require modern solutions. I think I just left test data in.
                        var partialNameMatch =  nameField.toLowerCase().includes(searchInput);

                        // City - full match 
                        city = result.event.source.default_city.toLowerCase();
                        cityMatch = city.includes(searchInput);

                        // Partner - full match ( doesn't seem like it would be used )
                        partner = result.event.source.friendly_name.toLowerCase();
                        partnerMatch = partner.includes(searchInput)

                        return partialNameMatch || cityMatch || partnerMatch;
                    })

                    return results;
                },   
          },
          methods: {
            fetchAPI: function() { 
                fetch("/get_events?today=true").then(
                    response=>response.json())
                    .then(data=> {
                        this.loading = false;
                        data.forEach(x => { 
                            // Shorten long descriptions for now
                            x.event.description = x.event.description.slice(0,60) + "...";
                            // Dates - I am sure there is a vue lib for this, but for this demo..
                            da = new Date(x.start_datetime)
                            x.start_datetime = da.getDay() + '/' + da.getMonth() + '/' + da.getFullYear()
                            var mins = da.getMinutes()<10?'00':'' + da.getMinutes();
                            var hours = da.getHours()<10?'00':''  + da.getHours();
                            x.start_clocktime = hours + ':' + mins
                        
                    });
                    this.results=data;
                });
            },
        },
          beforeMount() {
              this.fetchAPI();
          }
        });


        // More fades are needed. Clearly.
        new Vue({
            el: '#navgroup',
            data: {
                showMenu: false
            }
        })

    </script>

</body>

</html>
